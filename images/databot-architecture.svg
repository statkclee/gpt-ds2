<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500">
  <defs>
    <style>
      .tufte-text {
        font-family: Palatino, 'Book Antiqua', Georgia, serif;
        fill: #333;
        font-size: 14px;
      }
      .tufte-title {
        font-family: Palatino, 'Book Antiqua', Georgia, serif;
        fill: #333;
        font-size: 18px;
        font-weight: bold;
      }
      .tufte-subtitle {
        font-family: Palatino, 'Book Antiqua', Georgia, serif;
        fill: #666;
        font-size: 12px;
      }
      .tufte-small {
        font-family: Palatino, 'Book Antiqua', Georgia, serif;
        fill: #666;
        font-size: 11px;
      }
      .layer-box {
        fill: #fff;
        stroke: #333;
        stroke-width: 2;
      }
      .component-box {
        fill: #f5f5f5;
        stroke: #666;
        stroke-width: 1.5;
      }
      .data-box {
        fill: #fff;
        stroke: #999;
        stroke-width: 1;
        stroke-dasharray: 4,2;
      }
      .arrow {
        stroke: #666;
        stroke-width: 1.5;
        fill: none;
        marker-end: url(#arrowhead);
      }
      .bidirectional {
        stroke: #666;
        stroke-width: 1.5;
        fill: none;
        marker-start: url(#arrowhead2);
        marker-end: url(#arrowhead);
      }
    </style>
    <marker id="arrowhead" markerWidth="8" markerHeight="8" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#666" />
    </marker>
    <marker id="arrowhead2" markerWidth="8" markerHeight="8" refX="1" refY="3" orient="auto">
      <polygon points="8 0, 0 3, 8 6" fill="#666" />
    </marker>
  </defs>

  <!-- Background -->
  <rect x="0" y="0" width="900" height="500" fill="#ffffff"/>

  <!-- Title -->
  <text x="450" y="30" class="tufte-title" text-anchor="middle">Databot 아키텍처</text>
  <text x="450" y="50" class="tufte-subtitle" text-anchor="middle">R 세션 내 통합 AI 부조종사</text>

  <!-- Layer 1: 사용자 인터페이스 -->
  <rect x="50" y="80" width="800" height="80" class="layer-box" rx="8"/>
  <text x="60" y="100" class="tufte-title">사용자 인터페이스</text>

  <rect x="80" y="110" width="180" height="40" class="component-box" rx="5"/>
  <text x="170" y="130" class="tufte-text" text-anchor="middle">Shiny Gadget</text>
  <text x="170" y="145" class="tufte-small" text-anchor="middle">대화형 UI</text>

  <rect x="300" y="110" width="180" height="40" class="component-box" rx="5"/>
  <text x="390" y="130" class="tufte-text" text-anchor="middle">RStudio Addin</text>
  <text x="390" y="145" class="tufte-small" text-anchor="middle">키보드 단축키</text>

  <rect x="520" y="110" width="180" height="40" class="component-box" rx="5"/>
  <text x="610" y="130" class="tufte-text" text-anchor="middle">Positron 통합</text>
  <text x="610" y="145" class="tufte-small" text-anchor="middle">IDE 네이티브</text>

  <!-- Layer 2: Databot 코어 -->
  <rect x="50" y="190" width="800" height="110" class="layer-box" rx="8"/>
  <text x="60" y="210" class="tufte-title">Databot 코어</text>

  <rect x="80" y="220" width="150" height="60" class="component-box" rx="5"/>
  <text x="155" y="240" class="tufte-text" text-anchor="middle">자연어 처리</text>
  <text x="155" y="255" class="tufte-small" text-anchor="middle">프롬프트 구성</text>
  <text x="155" y="270" class="tufte-small" text-anchor="middle">컨텍스트 추가</text>

  <rect x="270" y="220" width="150" height="60" class="component-box" rx="5"/>
  <text x="345" y="240" class="tufte-text" text-anchor="middle">코드 생성기</text>
  <text x="345" y="255" class="tufte-small" text-anchor="middle">R 코드 변환</text>
  <text x="345" y="270" class="tufte-small" text-anchor="middle">Tidyverse 스타일</text>

  <rect x="460" y="220" width="150" height="60" class="component-box" rx="5"/>
  <text x="535" y="240" class="tufte-text" text-anchor="middle">실행 엔진</text>
  <text x="535" y="255" class="tufte-small" text-anchor="middle">R 세션 내 실행</text>
  <text x="535" y="270" class="tufte-small" text-anchor="middle">결과 캡처</text>

  <rect x="650" y="220" width="150" height="60" class="component-box" rx="5"/>
  <text x="725" y="240" class="tufte-text" text-anchor="middle">보고서 생성</text>
  <text x="725" y="255" class="tufte-small" text-anchor="middle">Quarto 문서</text>
  <text x="725" y="270" class="tufte-small" text-anchor="middle">재현 가능</text>

  <!-- Layer 3: AI 백엔드 -->
  <rect x="50" y="330" width="800" height="60" class="layer-box" rx="8"/>
  <text x="60" y="350" class="tufte-title">AI 백엔드</text>

  <rect x="200" y="360" width="500" height="25" class="component-box" rx="5"/>
  <text x="450" y="377" class="tufte-text" text-anchor="middle">Claude 3.5 Sonnet (Anthropic API)</text>

  <!-- Layer 4: R 환경 -->
  <rect x="50" y="420" width="800" height="60" class="layer-box" rx="8"/>
  <text x="60" y="440" class="tufte-title">R 환경</text>

  <rect x="80" y="450" width="160" height="25" class="data-box" rx="5"/>
  <text x="160" y="467" class="tufte-small" text-anchor="middle">데이터프레임</text>

  <rect x="270" y="450" width="160" height="25" class="data-box" rx="5"/>
  <text x="350" y="467" class="tufte-small" text-anchor="middle">패키지</text>

  <rect x="460" y="450" width="160" height="25" class="data-box" rx="5"/>
  <text x="540" y="467" class="tufte-small" text-anchor="middle">함수</text>

  <rect x="650" y="450" width="160" height="25" class="data-box" rx="5"/>
  <text x="730" y="467" class="tufte-small" text-anchor="middle">파일 시스템</text>

  <!-- Arrows -->
  <!-- UI to Core -->
  <path d="M 170 150 L 170 220" class="arrow"/>
  <path d="M 390 150 L 345 220" class="arrow"/>
  <path d="M 610 150 L 535 220" class="arrow"/>

  <!-- Core internal -->
  <path d="M 230 250 L 270 250" class="arrow"/>
  <path d="M 420 250 L 460 250" class="arrow"/>
  <path d="M 610 250 L 650 250" class="arrow"/>

  <!-- Core to AI Backend -->
  <path d="M 345 280 L 345 360" class="arrow"/>
  <path d="M 555 360 L 555 280" class="arrow"/>

  <!-- Core to R Environment -->
  <path d="M 155 280 L 155 450" class="bidirectional"/>
  <path d="M 350 280 L 350 450" class="bidirectional"/>
  <path d="M 540 280 L 540 450" class="bidirectional"/>
</svg>
